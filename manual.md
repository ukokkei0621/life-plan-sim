📘 Life Plan Simulator 開発・運用マニュアル

このドキュメントは、今回作成した「ライフプランシミュレーター」の仕組み、エラー解決を経てたどり着いた「正解の構成」、そして今後の「更新方法」をまとめたものです。

1. 今回やったこと：全体像の整理

私たちは以下の3つの場所を使って、Webアプリを公開しました。

🏗️ 仕組みのイメージ

ローカル (あなたのPC)

役割: 工房。ここでコードを書いたり修正したりします。

主な道具: VS Code（エディタ）、Terminal（黒い画面）。

GitHub (インターネット上の倉庫)

役割: バックアップ兼、受け渡し場所。PCから送られたコードを保管します。

Vercel (公開サーバー)

役割: 展示場。GitHubに変更が届くと、それを自動で検知してWebサイトとして組み立て（ビルド）、世界中に公開します。

流れ:
PCで編集 → GitHubへ送信(Push) → Vercelが自動更新

2. 苦戦したポイントと「最終的な正解」

今回の最大の壁は 「Tailwind CSS v4 の導入設定」 でした。
エラーが発生した原因と、最終的に成功した設定（＝正解）を記録します。

❌ 起きていたエラー

症状: npm run build や Vercel でのデプロイ時に「PostCSSの設定がおかしい」「ES Moduleでは require や module.exports が使えない」というエラーが出た。

原因:

最新版の Tailwind CSS (v4) を入れたが、設定ファイルが古い書き方 (v3) だった。

プロジェクト全体が「新しいJavaScript (ESM)」設定なのに、設定ファイルだけ「古い書き方 (CommonJS)」で書き、拡張子が .js のままだったため、Node.jsが混乱した。

✅ 最終的な「正解」の構成

今後、同様の環境を作る場合は、最初から以下の構成にすれば一発で動きます。

1. 必要なインストール物

npm install -D tailwindcss @tailwindcss/postcss postcss autoprefixer


@tailwindcss/postcss: これがv4を使うための肝となる新しいプラグインでした。

2. CSSファイル (src/index.css)

/* これが最新の書き方。以前の @tailwind base; などは古い */
@import "tailwindcss";


3. 設定ファイル (postcss.config.cjs) ★最重要

ファイル名が .js ではなく .cjs であることが重要です。

場所: プロジェクトルート（一番上の階層）

中身:

module.exports = {
  plugins: {
    '@tailwindcss/postcss': {}, // ここで新しいプラグインを指定
    autoprefixer: {},
  },
}


解説: .cjs にすることで、「このファイルだけは古い書き方（CommonJS）で読み込んでね」とシステムに指示でき、エラーが解消しました。

3. Geminiで修正してローカルに移す時の「鉄の掟」

Gemini（この画面）でコードを修正・確認した後、それをローカル環境に移す際は**「部分コピー」**が鉄則です。
決してファイル一式をダウンロードして上書きしてはいけません。 設定ファイルが先祖返りして動かなくなります。

✅ コピーしてOKなファイル（上書き対象）

アプリの「中身」に関するファイルだけをコピーします。

src/App.jsx

ロジックや画面のメイン部分。Geminiで修正した内容の9割はこれです。

VS Codeで src/App.jsx を開き、中身を全消しして、Geminiのコードを貼り付けてください。

src/index.css

デザイン調整をした場合のみ。

ただし、先頭の @import "tailwindcss"; は消さないように注意してください。

⛔ 絶対にコピー・上書きしてはいけないファイル

これらはローカル環境で苦労して「正解の状態」にしたものです。Geminiが提示するファイルは一般的な設定の場合があり、上書きするとまたビルドエラー地獄に戻ります。

package.json / package-lock.json

依存関係のリスト。ローカルにはv4対応版が入っていますが、Gemini版には入っていない可能性があります。

postcss.config.cjs (または .js)

ここを上書きすると、.cjs にリネームした努力が無駄になります。

vite.config.js

実際の作業フロー

Gemini上で要望を出し、プレビューで動作を確認する。

完成したら、Gemini上のコードブロック（src/App.jsxなど）のコピーボタンを押す。

ローカルのVS Codeで、対応するファイルだけを開く。

見分け方: Geminiのコードブロックの左上やタイトルに src/App.jsx のようなファイル名が書いてあります。

VS Codeの左側のファイル一覧（エクスプローラー）から、同じ名前のファイルを探してクリックします。

中身を入れ替えて保存する。

ローカルで npm run dev して最終確認する。

4. 【最重要】後日、Geminiで開発を再開する方法

Geminiは会話が長くなったり、日数が空いたりすると、過去のコードを完全に忘れます。
「続きをやって」と言っても、「どのコードですか？」となったり、勝手に別のコードを作り始めたりします。

次回以降、修正作業をするときは、以下の**「復活の儀式」**を必ず行ってください。

ローカルのコードをコピーする

自分のPCの VS Code で src/App.jsx を開く。

全選択（Ctrl+A）してコピー（Ctrl+C）。

Geminiに貼り付けて指示する

Geminiの新しいチャットを開く。

「以下のコードが現状のアプリです。これを読み込んで、〇〇という機能を追加してください」 と入力し、その下にコードを貼り付けて送信。

この「手動バックアップからの復元」こそが、唯一にして最強の「保存・呼び出し方法」です。
Geminiを「保存場所」と思わず、「その場限りの優秀な作業員」と考え、設計図（コード）は常に自分が渡してあげる運用にすると失敗しません。

5. 今後の更新方法（ここを一番使います）

アプリの金額設定を変えたり、デザインを修正したりしたくなった時の手順です。

ステップ 1：PCでコードを編集する

VS Codeを開き、修正したいファイルを編集して保存（Ctrl + S）します。
※ Geminiで作ったコードをコピペする場合もここで行います。

文字や計算を変えたい: src/App.jsx

見た目を変えたい: src/App.jsx の className="..." の部分

ステップ 2：プレビューで確認する

修正したら、手元のPCで動作確認します。

VS Codeのメニュー「ターミナル」→「新しいターミナル」を開く。

以下のコマンドを入力：

npm run dev


表示されたURL（例: http://localhost:5173）をブラウザで開き、動きを確認。

確認が終わったら、ターミナルで Ctrl + C を押して停止。

ステップ 3：変更を公開する（Vercelへ反映）

「これでOK！」と思ったら、以下の3つの呪文（コマンド）をターミナルで順番に打ち込むだけです。

① 変更を荷造りする

git add .


（最後のドット . を忘れずに！）

② 荷物にラベルを貼る（コミット）

git commit -m "修正内容のメモ"


（例: git commit -m "update text" や git commit -m "fix color" など。英語推奨ですが、自分用ならローマ字でもOK）

③ GitHubへ発送する（プッシュ）

git push


🚀 あとは待つだけ

git push が成功したら、あなたの作業は完了です。

GitHubが変更を受け取ります。

Vercelがそれを検知して、勝手に新しいバージョンを作り始めます。

1〜2分後、あなたのWebサイトのURLにアクセスすると、内容が更新されています。

6. もしまたエラーが出たら？

もし久しぶりに触ってエラーが出た場合は、以下の「リセット手順」を試してください。

node_modules フォルダを削除

VS Codeの左側の一覧から node_modules を右クリックして削除。

package-lock.json を削除（package.json は消さないで！）

再インストール

ターミナルで npm install を実行。

これで環境が綺麗になります。

7. このマニュアル自体の保存について（重要）

このドキュメントも、Geminiのチャット履歴上だけでは消えるリスクがあります。
以下の手順で、プロジェクトの一部として保存してしまうことを強くおすすめします。

VS Codeで新しいファイルを作る

プロジェクトのフォルダ（ルート）で、新しいファイルを作成ボタンを押す。

ファイル名: MANUAL.md

内容をコピー＆ペースト

この画面のマニュアルの中身を全選択してコピー。

VS Codeの MANUAL.md に貼り付けて保存。

Gitに登録（任意）

いつものように git add . → git commit → git push をすれば、このマニュアルもGitHub上に永久保存されます。

これで、いつ開発を再開しても「あの時の手順」がすぐに見つかります！